!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):n.ES6Promise=r()}(this,(function(){"use strict";function e(n){return"function"==typeof n}function c(){var n=setTimeout;return function(){return n(a,1)}}function a(){for(var n=0;n<o;n+=2){(0,m[n])(m[n+1]),m[n]=void 0,m[n+1]=void 0}o=0}function l(n,r){var o=this,i=new this.constructor(p);void 0===i[M]&&O(i);var s=o._state;if(s){var u=arguments[s-1];G((function(){return P(s,i,u,o._result)}))}else E(o,i,n,r);return i}function h(n){if(n&&"object"==typeof n&&n.constructor===this)return n;var r=new this(p);return g(r,n),r}function p(){}function _(n){try{return n.then}catch(n){return Y.error=n,Y}}function w(n,r,o){r.constructor===n.constructor&&o===l&&r.constructor.resolve===h?function(n,r){r._state===C?S(n,r._result):r._state===F?j(n,r._result):E(r,void 0,(function(r){return g(n,r)}),(function(r){return j(n,r)}))}(n,r):o===Y?(j(n,Y.error),Y.error=null):void 0===o?S(n,r):e(o)?function(n,r,o){G((function(n){var i=!1,s=function(n,r,o,i){try{n.call(r,o,i)}catch(n){return n}}(o,r,(function(o){i||(i=!0,r!==o?g(n,o):S(n,o))}),(function(r){i||(i=!0,j(n,r))}),n._label);!i&&s&&(i=!0,j(n,s))}),n)}(n,r,o):S(n,r)}function g(n,r){n===r?j(n,new TypeError("You cannot resolve a promise with itself")):function(n){var r=typeof n;return null!==n&&("object"===r||"function"===r)}(r)?w(n,r,_(r)):S(n,r)}function A(n){n._onerror&&n._onerror(n._result),T(n)}function S(n,r){n._state===x&&(n._result=r,n._state=C,0!==n._subscribers.length&&G(T,n))}function j(n,r){n._state===x&&(n._state=F,n._result=r,G(A,n))}function E(n,r,o,i){var s=n._subscribers,u=s.length;n._onerror=null,s[u]=r,s[u+C]=o,s[u+F]=i,0===u&&n._state&&G(T,n)}function T(n){var r=n._subscribers,o=n._state;if(0!==r.length){for(var i=void 0,s=void 0,u=n._result,f=0;f<r.length;f+=3)i=r[f],s=r[f+o],i?P(o,i,s,u):s(u);n._subscribers.length=0}}function P(n,r,o,i){var s=e(o),u=void 0,f=void 0,v=void 0,d=void 0;if(s){if(u=function(n,r){try{return n(r)}catch(n){return Y.error=n,Y}}(o,i),u===Y?(d=!0,f=u.error,u.error=null):v=!0,r===u)return void j(r,new TypeError("A promises callback cannot return that same promise."))}else u=i,v=!0;r._state!==x||(s&&v?g(r,u):d?j(r,f):n===C?S(r,u):n===F&&j(r,u))}function O(n){n[M]=k++,n._state=void 0,n._result=void 0,n._subscribers=[]}var n;n=Array.isArray?Array.isArray:function(n){return"[object Array]"===Object.prototype.toString.call(n)};var r=n,o=0,i=void 0,s=void 0,G=function(n,r){m[o]=n,m[o+1]=r,2===(o+=2)&&(s?s(a):b())},u="undefined"!=typeof window?window:void 0,f=u||{},v=f.MutationObserver||f.WebKitMutationObserver,d="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),y="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,m=new Array(1e3),b=void 0;b=d?function(){return process.nextTick(a)}:v?function(){var n=0,r=new v(a),o=document.createTextNode("");return r.observe(o,{characterData:!0}),function(){o.data=n=++n%2}}():y?function(){var n=new MessageChannel;return n.port1.onmessage=a,function(){return n.port2.postMessage(0)}}():void 0===u&&"function"==typeof require?function(){try{var n=Function("return this")().require("vertx");return void 0!==(i=n.runOnLoop||n.runOnContext)?function(){i(a)}:c()}catch(n){return c()}}():c();var M=Math.random().toString(36).substring(2),x=void 0,C=1,F=2,Y={error:null},k=0,q=function(){function t(n,o){this._instanceConstructor=n,this.promise=new n(p),this.promise[M]||O(this.promise),r(o)?(this.length=o.length,this._remaining=o.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(o),0===this._remaining&&S(this.promise,this._result))):j(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(n){for(var r=0;this._state===x&&r<n.length;r++)this._eachEntry(n[r],r)},t.prototype._eachEntry=function(n,r){var o=this._instanceConstructor,i=o.resolve;if(i===h){var s=_(n);if(s===l&&n._state!==x)this._settledAt(n._state,r,n._result);else if("function"!=typeof s)this._remaining--,this._result[r]=n;else if(o===D){var u=new o(p);w(u,n,s),this._willSettleAt(u,r)}else this._willSettleAt(new o((function(r){return r(n)})),r)}else this._willSettleAt(i(n),r)},t.prototype._settledAt=function(n,r,o){var i=this.promise;i._state===x&&(this._remaining--,n===F?j(i,o):this._result[r]=o),0===this._remaining&&S(i,this._result)},t.prototype._willSettleAt=function(n,r){var o=this;E(n,void 0,(function(n){return o._settledAt(C,r,n)}),(function(n){return o._settledAt(F,r,n)}))},t}(),D=function(){function t(n){this[M]=k++,this._result=this._state=void 0,this._subscribers=[],p!==n&&("function"!=typeof n&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(n,r){try{r((function(r){g(n,r)}),(function(r){j(n,r)}))}catch(r){j(n,r)}}(this,n):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(n){return this.then(null,n)},t.prototype.finally=function(n){var r=this,o=r.constructor;return e(n)?r.then((function(r){return o.resolve(n()).then((function(){return r}))}),(function(r){return o.resolve(n()).then((function(){throw r}))})):r.then(n,n)},t}();return D.prototype.then=l,D.all=function(n){return new q(this,n).promise},D.race=function(n){var o=this;return new o(r(n)?function(r,i){for(var s=n.length,u=0;u<s;u++)o.resolve(n[u]).then(r,i)}:function(n,r){return r(new TypeError("You must pass an array to race."))})},D.resolve=h,D.reject=function(n){var r=new this(p);return j(r,n),r},D._setScheduler=function(n){s=n},D._setAsap=function(n){G=n},D._asap=G,D.polyfill=function(){var n=void 0;if("undefined"!=typeof global)n=global;else if("undefined"!=typeof self)n=self;else try{n=Function("return this")()}catch(n){throw new Error("polyfill failed because global object is unavailable in this environment")}var r=n.Promise;if(r){var o=null;try{o=Object.prototype.toString.call(r.resolve())}catch(n){}if("[object Promise]"===o&&!r.cast)return}n.Promise=D},D.Promise=D,D.polyfill(),D}));